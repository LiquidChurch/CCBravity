var gfRepeater_debug=false;var gfRepeater_repeaters={};var gfRepeater_submitted=false;function gfRepeater_getRepeaters(){var a=jQuery(".gform_wrapper").each(function(){var g={};var o=this.id.split("_")[2];var b=jQuery(this).children("form").first();var j=0;var m=0;var d=0;var p=0;var h=null;var f={};var l={};var k={};var c={};var e;var n;if(jQuery(b).attr("action")=="/ajax-test"){jQuery(b).removeAttr("action")}jQuery(this).find(".gfield").each(function(){if(m==0){if(jQuery(this).has(".ginput_container_repeater").length){j+=1;if(gfRepeater_debug){console.log("Form #"+o+" - Repeater #"+j+" - Start: "+jQuery(this).attr("id"))}n=jQuery(this);e=n.find(".gform_repeater");f=jQuery(e).val();if(f){f=JSON.parse(f)}if(jQuery.captures()){c=jQuery.captures(e.attr("name"));if(c){c=JSON.parse(c);if(j==1&&c.formId==o){gfRepeater_submitted=true}}}if(j==1){jQuery(b).capture()}m=1}}else{if(jQuery(this).has(".ginput_container_repeater").length){return false}if(jQuery(this).has(".ginput_container_repeater-end").length){if(gfRepeater_debug){console.log("Form #"+o+" - Repeater #"+j+" - End: "+jQuery(this).attr("id"));console.log("Form #"+o+" - Repeater #"+j+" - Children Found: "+(d))}var z={};var w=jQuery(this);var y=w.find(".gf_repeater_add");var L=w.find(".gf_repeater_remove");var A="gfRepeater_repeatRepeater("+o+","+j+");";var t="gfRepeater_unrepeatRepeater("+o+","+j+");";jQuery(y).attr({onclick:A,onkeypress:A});jQuery(L).attr({onclick:t,onkeypress:t});z={add:y,remove:L,data:e,start:n,end:w};var P={};var Q=Number(f.start);var J=Number(f.min);var M=Number(f.max);if(!Q||(M&&Q>M)){Q=1}if(!J||(M&&J>M)){J=1}if(!M||(J&&M&&J>M)){M=null}P={start:Q,min:J,max:M};var R={};var s=Number(e.attr("tabindex"));var D=null;if(gfRepeater_submitted&&c){D=c.repeatCount}R={repeatCount:1,prevRepeatCount:D,childrenCount:d,paremCount:p,tabIndex:s,inputData:k};g[j]={data:R,settings:P,controllers:z,children:l};m=0;d=0;p=0;h=null;l={};k={};repeaterChildrenPrePopulate={};repeaterRequiredChildren=null}else{d+=1;var C=jQuery(this);var N=jQuery(this).children(".gfield_label").text();var I=jQuery(this).attr("id");var K=I.split("_")[2];var H={};var E=[];var x=0;var O=false;var u=f.children[K];var v=h;var G;var q;var r;if(jQuery(this).has(".ginput_container").length){var B=jQuery(this).find(".ginput_container").attr("class").split(/\s+/);var F="ginput_container_";jQuery.each(B,function(S,T){if(T.slice(0,F.length)==F){G=T.slice(F.length,T.length)}})}else{if(jQuery(this).hasClass("gform_hidden")){G="hidden"}else{if(jQuery(this).hasClass("gsection")){G="section"}}}if(G=="section"){h=d;v=null}if(u.required){O=true}if(u.inputMask){q=u.inputMask}if(u.conditionalLogic){r=u.conditionalLogic;r.skip=[]}if(gfRepeater_debug){console.log("Form #"+o+" - Repeater #"+j+" - Child #"+d+" - Found: "+I)}jQuery(this).find(":input").each(function(){x+=1;var X=jQuery(this);var V=jQuery(this).attr("id");var W=jQuery(this).attr("name");var S;var U=gfRepeater_getInputValue(X);var T={};if(W){if(jQuery.inArray(W,E)==-1){E.push(W)}if(W.slice(-2)=="[]"){S=W.slice(0,W.length-2)}else{S=W}if(u.prePopulate){if(G=="checkbox"||G=="radio"){T=u.prePopulate}else{if(u.prePopulate[S.split("_")[1]]){T=u.prePopulate[S.split("_")[1]]}}if(T){jQuery.each(T,function(Y,Z){if(Y>p){p=Number(Y)}})}}}H[x]={element:X,id:V,name:W,defaultValue:U,prePopulate:T};if(gfRepeater_debug){console.log("Form #"+o+" - Repeater #"+j+" - Child #"+d+" - Input Found: "+V)}});l[d]={element:C,id:I,idNum:K,inputs:H,inputCount:x,required:O,type:G,inputMask:q,conditionalLogic:r,parentSection:v};k[K]=E}}});if(gfRepeater_debug){console.log("Form #"+o+" - Repeaters Found: "+(j))}if(m!==0){return false}if(g){gfRepeater_repeaters[o]=g;return true}});if(a){return true}else{return false}}function gfRepeater_setRepeaterChildAttrs(r,p,g,m){var b=gfRepeater_repeaters[r][p];if(!m){var m=b.data["repeatCount"]+1}var l=jQuery(g).attr("id").split("-")[0];var h=gfRepeater_getIndex(b.children,"id",l);var o=jQuery("#gform_wrapper_"+r).hasClass("gform_validation_error");if(h){var d=false;var f=b.children[h];var q=f.required;var k=f.type;var j=f.inputCount;var c=f.inputMask;var s=b.data["tabIndex"];var a=l+"-"+p+"-"+m;jQuery(g).attr("id",a).attr("data-repeater-parentId",p).attr("data-repeater-repeatId",m).attr("data-repeater-childId",h).addClass("gf_repeater_child_field");gfRepeater_replaceShortcodes(g);gfRepeater_doShortcode(g,"count",m);gfRepeater_doShortcode(g,"buttons",b.controllers["add"].parent().clone());gfRepeater_doShortcode(g,"add",b.controllers["add"].clone());gfRepeater_doShortcode(g,"remove",b.controllers["remove"].clone());var e="gfRepeater_unrepeatRepeater("+r+","+p+","+m+");";jQuery(g).find(".gf_repeater_remove").attr({onclick:e,onkeypress:e}).show();jQuery(g).find(".gf_repeater_add").show();jQuery.each(b.children[h]["inputs"],function(C,z){var A=this["id"];var y=this["name"];var w="";if(k=="radio"){var D=gfRepeater_findElementByNameOrId(g,null,A)}else{var D=gfRepeater_findElementByNameOrId(g,y,A)}D.attr("data-repeater-inputId",C);if(A){var u=A+"-"+p+"-"+m;jQuery(D).attr("id",u);jQuery(g).find("label[for^='"+A+"']").attr("for",u)}if(y){if(y.slice(-2)=="[]"){var x=y.slice(0,y.length-2)+"-"+p+"-"+m+"[]"}else{var x=y+"-"+p+"-"+m}jQuery(D).attr("name",x).attr("tabindex",s)}if(c){jQuery(D).mask(c)}if(this["prePopulate"][m]){w=this["prePopulate"][m]}else{if(this["prePopulate"][0]){w=this["prePopulate"][0]}}if(w){if(k=="checkbox"||k=="radio"){prePopulateValues=w.split(",");if(jQuery.inArray(C,prePopulateValues)!==-1){w=true}else{w=false}}gfRepeater_setInputValue(D,w)}if(window.gformInitDatepicker&&k=="date"&&j==2&&C==1){jQuery(D).removeClass("hasDatepicker").datepicker("destroy").siblings(".ui-datepicker-trigger").remove()}if(gfRepeater_submitted&&o){if(x){var t=jQuery.captures(x);if(t){gfRepeater_setInputValue(D,t)}}if(q){if(x){var B=x.replace(".","_").split(/(_|-)/);if(k=="name"&&jQuery.inArray(B[4],["3","6"])==-1){return true}if(k=="address"&&jQuery.inArray(B[4],["2"])!==-1){return true}}var v=gfRepeater_getInputValue(D);if(!v&&m<=b.data["prevRepeatCount"]){d=true}}}});if(q){var n=g.children(".gfield_label");g.addClass("gfield_contains_required");if(!n.has(".gfield_required").length){n.append('<span class="gfield_required">*</span>')}if(gfRepeater_submitted&&o){if(d){g.addClass("gfield_error");if(!g.has(".validation_message").length){g.append('<div class="gfield_description validation_message">This field is required.</div>')}}else{g.removeClass("gfield_error").find(".validation_message").remove()}}}}}function gfRepeater_resetRepeaterChildrenAttrs(d,b){var c=gfRepeater_select(d,b);var a=0;jQuery(c).each(function(){if(jQuery(this).attr("data-repeater-childid")==1){a+=1}if(jQuery(this).attr("data-repeater-repeatid")!==a){gfRepeater_setRepeaterChildAttrs(d,b,jQuery(this),a)}})}function gfRepeater_conditionalLogic_set(f,a,g,e){gfRepeater_conditionalLogic_do(f,a,g,e);var d=gfRepeater_repeaters[f][a];var b=d.children[g];var c=b.conditionalLogic;jQuery.each(c.rules,function(k,l){var j=l.fieldId;var m=gfRepeater_getIndex(d.children,"idNum",j);if(m!==false){var h=gfRepeater_select(f,a,e,m,"*")}else{var h=jQuery("#field_"+f+"_"+j+" :input");e=null}jQuery.each(h,function(o,n){jQuery(this).bind("propertychange change click keyup input paste",function(){gfRepeater_conditionalLogic_do(f,a,g,e)})})})}function gfRepeater_conditionalLogic_setAll(d,a,c){var b=gfRepeater_repeaters[d][a];jQuery.each(b.children,function(e,f){if(this.conditionalLogic){gfRepeater_conditionalLogic_set(d,a,e,c)}})}function gfRepeater_conditionalLogic_do(h,b,g,m){var c=gfRepeater_repeaters[h][b];var l=c.children[g];var d=l.conditionalLogic;var j=[g];var e=[];var f=false;var k=false;jQuery.each(d.rules,function(x,w){var p=false;var u=w.fieldId;var t=gfRepeater_getIndex(c.children,"idNum",u);if(t!==false){var o=c.children[t];var s=gfRepeater_select(h,b,m,t);if(o.type=="checkbox"||o.type=="radio"){var q=gfRepeater_getChoiceValue(s);var v=true}else{var y=gfRepeater_select(h,b,m,t,1);var q=gfRepeater_getInputValue(y);var v=false}}else{var n=jQuery("#field_"+h+"_"+u);var r=n.find(":input").first();if(r.is(":checkbox, :radio")){var q=gfRepeater_getChoiceValue(n);var v=true}else{var q=gfRepeater_getInputValue(r);var v=false}}if(v){if(jQuery.inArray(w.value,q)!==-1){q=w.value}else{q=false}}p=gf_matches_operation(q,w.value,w.operator);e.push(p)});if(d.logicType=="all"){if(jQuery.inArray(false,e)==-1){f=true}}else{if(jQuery.inArray(true,e)!==-1){f=true}}if((f&&d.actionType!=="show")||(!f&&d.actionType=="show")){k=true}if(l.type=="section"){var a=gfRepeater_getIndex(c.children,"parentSection",g,true);if(a!==false){j=j.concat(a)}}jQuery.each(j,function(n,p){var o=c.children[p];var t=o.conditionalLogic;var q=gfRepeater_select(h,b,m,p);var r=m;if(r==null){r="all"}if(q.length){if(k){q.hide();if(t){if(jQuery.inArray(r,t.skip)==-1){t.skip.push(r)}}}else{q.show();if(t){if(jQuery.inArray(r,t.skip)!==-1){var s=t.skip.indexOf(r);t.skip.splice(s,1)}}}}});gfRepeater_updateDataElement(h,b)}function gfRepeater_doShortcode(a,b,c){a.find(".gfRepeater-shortcode-"+b).each(function(){jQuery(this).html(c)})}function gfRepeater_replaceShortcodes(b){var a=["count","buttons","add","remove"];jQuery.each(a,function(d,e){var c=b.html();b.html(c.replace("[gfRepeater-"+e+"]",'<span class="gfRepeater-shortcode-'+e+'"></span>'))})}function gfRepeater_repeatRepeater(e,a){var b=gfRepeater_repeaters[e][a];var d=b.data["repeatCount"]+1;if(b.settings["max"]&&b.data["repeatCount"]>=b.settings["max"]){return}jQuery(b.controllers["start"]).parents("form").trigger("gform_repeater_before_repeat",[a,d]);var f=gfRepeater_select(e,a).last();var c=jQuery(".gf_repeater_add").parents("li");jQuery.each(b.children,function(h,j){var g=jQuery(this.element).clone();gfRepeater_resetInputs(e,a,h,g);gfRepeater_setRepeaterChildAttrs(e,a,g);g.insertBefore(c);f=g});gfRepeater_conditionalLogic_setAll(e,a,d);b.data["repeatCount"]+=1;gfRepeater_updateDataElement(e,a);gfRepeater_updateRepeaterControls(e,a);if(window.gformInitDatepicker){gformInitDatepicker()}jQuery(b.controllers["start"]).parents("form").trigger("gform_repeater_after_repeat",[a,d]);if(jQuery("[ccb-field='event.register_user_type']").length>0){if("family"==jQuery("[ccb-field='event.register_user_type']").val()){if(typeof user_profile_data!="undefined"){if(jQuery('[ccb-field="individual.family.id"]').length>0){jQuery('[ccb-field="individual.family.id"]').val(user_profile_data["individual.family.id"])}}}if(b.data["repeatCount"]<=2){jQuery("#gform_"+e).find(".gf_repeater_remove").hide()}else{jQuery("#gform_"+e).find(".gf_repeater_remove").show()}}if(gfRepeater_debug){console.log("Form #"+e+" - Repeater #"+a+" - repeated")}}function gfRepeater_unrepeatRepeater(d,a,c){var b=gfRepeater_repeaters[d][a];if(b.data["repeatCount"]<=b.settings["min"]){return}if(!c){var c=b.data["repeatCount"]}jQuery(b.controllers["start"]).parents("form").trigger("gform_repeater_before_unrepeat",[a,c]);jQuery.each(b.children,function(f,e){gfRepeater_select(d,a,c,f).remove()});b.data["repeatCount"]-=1;gfRepeater_updateDataElement(d,a);gfRepeater_updateRepeaterControls(d,a);if(c!==b.data["repeatCount"]+1){gfRepeater_resetRepeaterChildrenAttrs(d,a)}jQuery(b.controllers["start"]).parents("form").trigger("gform_repeater_after_unrepeat",[a,c]);if(b.data["repeatCount"]<=2){jQuery("#gform_"+d).find(".gf_repeater_remove").hide()}else{jQuery("#gform_"+d).find(".gf_repeater_remove").show()}if(gfRepeater_debug){console.log("Form #"+d+" - Repeater #"+a+" - Repeat #"+c+" - unrepeated")}}function gfRepeater_repeatRepeaterTimes(c,a,b){if(!b){var b=1}for(i=0;i<b;i++){gfRepeater_repeatRepeater(c,a)}}function gfRepeater_unrepeatRepeaterTimes(c,a,b){if(!b){var b=1}for(i=0;i<b;i++){gfRepeater_unrepeatRepeater(c,a)}}function gfRepeater_setRepeater(f,a,c){var d=gfRepeater_repeaters[f][a];var e=d.data["repeatCount"];if(c==e){return}else{if(c>e){var b=c-e;gfRepeater_repeatRepeaterTimes(f,a,b)}else{if(c<e){var b=e-c;gfRepeater_unrepeatRepeaterTimes(f,a,b)}}}}function gfRepeater_updateRepeaterControls(c,a){var b=gfRepeater_repeaters[c][a];if(b.settings["max"]){if(b.data["repeatCount"]>=b.settings["max"]){jQuery(b.controllers["add"]).hide()}else{jQuery(b.controllers["add"]).show()}}if(b.data["repeatCount"]<=b.settings["min"]){jQuery(b.controllers["remove"]).hide()}else{jQuery(b.controllers["remove"]).show()}}function gfRepeater_resetInputs(e,a,d,b){var c=gfRepeater_repeaters[e][a];jQuery.each(c.children[d]["inputs"],function(j,k){var g=this["id"];var h=this["name"];var f=this["defaultValue"];var l=gfRepeater_findElementByNameOrId(b,h,g);if(l){gfRepeater_setInputValue(l,f)}})}function gfRepeater_select(f,b,d,e,c){var a="div#gform_wrapper_"+f+">form#gform_"+f;if(b||d||e||c){a+=">.gform_body .gform_fields>.gfield.gf_repeater_child_field"}if(b){a+="[data-repeater-parentid="+b+"]"}if(d){a+="[data-repeater-repeatid="+d+"]"}if(e){a+="[data-repeater-childid="+e+"]"}if(c){if(c=="*"){a+=" [data-repeater-inputid]"}else{a+=" [data-repeater-inputid="+c+"]"}}return jQuery(a)}function gfRepeater_findElementByNameOrId(c,a,b){if(a){var d=jQuery(c).find("[name^='"+a+"']")}if(!d&&b){var d=jQuery(c).find("[id^='"+b+"']")}if(d){return d}else{return false}}function gfRepeater_getIndex(b,c,e,a){var d=[];jQuery.each(b,function(f,g){if(g[c]==e){d.push(f);if(!a){return false}}});if(d.length){if(a){return d}else{return d[0]}}else{return false}}function gfRepeater_getChoiceValue(a){var b=[];jQuery(a).find(":checkbox, :radio").each(function(){if(jQuery(this).prop("checked")==true){var d=this.id;var c=jQuery(this).siblings("label").first().text();b.push(c)}});return b}function gfRepeater_getInputValue(a){if(a.is(":checkbox, :radio")){if(a.prop("checked")==true){return true}else{return false}}else{return a.val()}}function gfRepeater_setInputValue(b,a){if(b.is(":checkbox, :radio")){if(a){b.prop("checked",true)}else{b.prop("checked",false)}}else{b.val(a)}}function gfRepeater_updateDataElement(e,c){var d=gfRepeater_repeaters[e][c];var b=jQuery(d.controllers["data"]);var a=jQuery(b).val();if(a){a=JSON.parse(a)}a.repeaterId=c;a.repeatCount=d.data["repeatCount"];jQuery.each(a.children,function(g,j){if(Array.isArray(this)){a.children[g]={}}var h=d.data["inputData"][g];if(h.length){a.children[g]["inputs"]=h}var f=gfRepeater_getIndex(d.children,"idNum",g);a.children[g]["conditionalLogic"]=d.children[f]["conditionalLogic"]});a=JSON.stringify(a);jQuery(b).val(a)}function gfRepeater_start(){jQuery.each(gfRepeater_repeaters,function(b,a){var d=b;var c=gfRepeater_select(d);jQuery.each(a,function(h,k){var e=h;var g=gfRepeater_repeaters[d][e];var f=g.settings["start"];var j=g.data["paremCount"];if(g.controllers["data"].attr("data-required")){g.controllers["start"].addClass("gfield_contains_required")}jQuery.each(g.children,function(l,m){gfRepeater_setRepeaterChildAttrs(d,e,jQuery(g.children[l]["element"]),1);if(this.conditionalLogic){gfRepeater_conditionalLogic_set(d,e,l,1)}});if(gfRepeater_submitted){f=g.data["prevRepeatCount"]}else{if(j>f){f=j}}gfRepeater_setRepeater(d,e,f);gfRepeater_updateRepeaterControls(d,e);gfRepeater_updateDataElement(d,e)});jQuery(c).trigger("gform_repeater_init_done")});if(window.gformInitDatepicker){gformInitDatepicker()}}if(gfRepeater_debug){jQuery(window).keydown(function(a){if(a.which==38){console.log(gfRepeater_repeaters)}if(a.which==40){console.log(jQuery.captures())}})};