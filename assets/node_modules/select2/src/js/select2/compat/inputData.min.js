define(["jquery"],function(b){function a(e,c,d){this._currentData=[];this._valueSeparator=d.get("valueSeparator")||",";if(c.prop("type")==="hidden"){if(d.get("debug")&&console&&console.warn){console.warn("Select2: Using a hidden input with Select2 is no longer supported and may stop working in the future. It is recommended to use a `<select>` element instead.")}}e.call(this,c,d)}a.prototype.current=function(e,i){function c(k,d){var j=[];if(k.selected||b.inArray(k.id,d)!==-1){k.selected=true;j.push(k)}else{k.selected=false}if(k.children){j.push.apply(j,c(k.children,d))}return j}var f=[];for(var h=0;h<this._currentData.length;h++){var g=this._currentData[h];f.push.apply(f,c(g,this.$element.val().split(this._valueSeparator)))}i(f)};a.prototype.select=function(c,e){if(!this.options.get("multiple")){this.current(function(f){b.map(f,function(g){g.selected=false})});this.$element.val(e.id);this.$element.trigger("change")}else{var d=this.$element.val();d+=this._valueSeparator+e.id;this.$element.val(d);this.$element.trigger("change")}};a.prototype.unselect=function(d,e){var c=this;e.selected=false;this.current(function(h){var f=[];for(var i=0;i<h.length;i++){var g=h[i];if(e.id==g.id){continue}f.push(g.id)}c.$element.val(f.join(c._valueSeparator));c.$element.trigger("change")})};a.prototype.query=function(c,i,j){var e=[];for(var h=0;h<this._currentData.length;h++){var g=this._currentData[h];var f=this.matches(i,g);if(f!==null){e.push(f)}}j({results:e})};a.prototype.addOptions=function(e,c){var d=b.map(c,function(f){return b.data(f[0],"data")});this._currentData.push.apply(this._currentData,d)};return a});