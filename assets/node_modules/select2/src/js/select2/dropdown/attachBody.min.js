define(["jquery","../utils"],function(c,b){function a(f,d,e){this.$dropdownParent=e.get("dropdownParent")||c(document.body);f.call(this,d,e)}a.prototype.bind=function(g,d,h){var f=this;var e=false;g.call(this,d,h);d.on("open",function(){f._showDropdown();f._attachPositioningHandler(d);if(!e){e=true;d.on("results:all",function(){f._positionDropdown();f._resizeDropdown()});d.on("results:append",function(){f._positionDropdown();f._resizeDropdown()})}});d.on("close",function(){f._hideDropdown();f._detachPositioningHandler(d)});this.$dropdownContainer.on("mousedown",function(i){i.stopPropagation()})};a.prototype.destroy=function(d){d.call(this);this.$dropdownContainer.remove()};a.prototype.position=function(d,e,f){e.attr("class",f.attr("class"));e.removeClass("select2");e.addClass("select2-container--open");e.css({position:"absolute",top:-999999});this.$container=f};a.prototype.render=function(d){var f=c("<span></span>");var e=d.call(this);f.append(e);this.$dropdownContainer=f;return f};a.prototype._hideDropdown=function(d){this.$dropdownContainer.detach()};a.prototype._attachPositioningHandler=function(j,d){var e=this;var g="scroll.select2."+d.id;var i="resize.select2."+d.id;var h="orientationchange.select2."+d.id;var f=this.$container.parents().filter(b.hasScroll);f.each(function(){c(this).data("select2-scroll-position",{x:c(this).scrollLeft(),y:c(this).scrollTop()})});f.on(g,function(l){var k=c(this).data("select2-scroll-position");c(this).scrollTop(k.y)});c(window).on(g+" "+i+" "+h,function(k){e._positionDropdown();e._resizeDropdown()})};a.prototype._detachPositioningHandler=function(i,d){var f="scroll.select2."+d.id;var h="resize.select2."+d.id;var g="orientationchange.select2."+d.id;var e=this.$container.parents().filter(b.hasScroll);e.off(f);c(window).off(f+" "+h+" "+g)};a.prototype._positionDropdown=function(){var g=c(window);var p=this.$dropdown.hasClass("select2-dropdown--above");var f=this.$dropdown.hasClass("select2-dropdown--below");var m=null;var h=this.$container.offset();h.bottom=h.top+this.$container.outerHeight(false);var e={height:this.$container.outerHeight(false)};e.top=h.top;e.bottom=h.top+e.height;var o={height:this.$dropdown.outerHeight(false)};var k={top:g.scrollTop(),bottom:g.scrollTop()+g.height()};var j=k.top<(h.top-o.height);var l=k.bottom>(h.bottom+o.height);var i={left:h.left,top:e.bottom};var n=this.$dropdownParent;if(n.css("position")==="static"){n=n.offsetParent()}var d=n.offset();i.top-=d.top;i.left-=d.left;if(!p&&!f){m="below"}if(!l&&j&&!p){m="above"}else{if(!j&&l&&p){m="below"}}if(m=="above"||(p&&m!=="below")){i.top=e.top-d.top-o.height}if(m!=null){this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+m);this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+m)}this.$dropdownContainer.css(i)};a.prototype._resizeDropdown=function(){var d={width:this.$container.outerWidth(false)+"px"};if(this.options.get("dropdownAutoWidth")){d.minWidth=d.width;d.position="relative";d.width="auto"}this.$dropdown.css(d)};a.prototype._showDropdown=function(d){this.$dropdownContainer.appendTo(this.$dropdownParent);this._positionDropdown();this._resizeDropdown()};return a});