define(["./select","../utils","jquery"],function(a,c,b){function d(e,f){var g=f.get("data")||[];d.__super__.constructor.call(this,e,f);this.addOptions(this.convertToOptions(g))}c.Extend(d,a);d.prototype.select=function(e){var f=this.$element.find("option").filter(function(g,h){return h.value==e.id.toString()});if(f.length===0){f=this.option(e);this.addOptions(f)}d.__super__.select.call(this,e)};d.prototype.convertToOptions=function(g){var q=this;var j=this.$element.find("option");var f=j.map(function(){return q.item(b(this)).id}).get();var i=[];function n(s){return function(){return b(this).val()==s.id}}for(var m=0;m<g.length;m++){var p=this._normalizeItem(g[m]);if(b.inArray(p.id,f)>=0){var k=j.filter(n(p));var l=this.item(k);var r=b.extend(true,{},p,l);var h=this.option(r);k.replaceWith(h);continue}var e=this.option(p);if(p.children){var o=this.convertToOptions(p.children);c.appendMany(e,o)}i.push(e)}return i};return d});