define(["jquery"],function(b){function a(f,c,d){var e=d.get("tokenizer");if(e!==undefined){this.tokenizer=e}f.call(this,c,d)}a.prototype.bind=function(d,c,e){d.call(this,c,e);this.$search=c.dropdown.$search||c.selection.$search||e.find(".select2-search__field")};a.prototype.query=function(f,g,i){var e=this;function d(k){var j=e._normalizeItem(k);var m=e.$element.find("option").filter(function(){return b(this).val()===j.id});if(!m.length){var l=e.option(j);l.attr("data-select2-tag",true);e._removeOldTags();e.addOptions([l])}c(j)}function c(j){e.trigger("select",{data:j})}g.term=g.term||"";var h=this.tokenizer(g,this.options,d);if(h.term!==g.term){if(this.$search.length){this.$search.val(h.term);this.$search.focus()}g.term=h.term}f.call(this,g,i)};a.prototype.tokenizer=function(k,e,o,n){var f=o.get("tokenSeparators")||[];var d=e.term;var h=0;var j=this.createTag||function(i){return{id:i.term,text:i.term}};while(h<d.length){var m=d[h];if(b.inArray(m,f)===-1){h++;continue}var c=d.substr(0,h);var l=b.extend({},e,{term:c});var g=j(l);if(g==null){h++;continue}n(g);d=d.substr(h+1)||"";h=0}return{term:d}};return a});